# Flow –∑–∞–≥—Ä—É–∑–∫–∏ CSV —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ Frontend

## üìã –°—Ö–µ–º–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞

### 1. **Frontend - –ö–Ω–æ–ø–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏**
   **–§–∞–π–ª:** `frontend/src/pages/DashboardPage.jsx`
   - **–°—Ç—Ä–æ–∫–∞ 86-97:** HTML input —Å —Ç–∏–ø–æ–º file –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º `handleFileUpload`
   - **–°—Ç—Ä–æ–∫–∞ 31-75:** –§—É–Ω–∫—Ü–∏—è `handleFileUpload`
     - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ (.csv)
     - –°–æ–∑–¥–∞–µ—Ç FormData
     - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `/api/v1/clients/upload-csv`

### 2. **Backend - API Endpoint**
   **–§–∞–π–ª:** `backend/app/api/v1/endpoints/clients.py`
   - **–°—Ç—Ä–æ–∫–∞ 17-109:** –§—É–Ω–∫—Ü–∏—è `upload_clients_csv`
   - **–ü—Ä–æ—Ü–µ—Å—Å:**
     1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ (—Å—Ç—Ä–æ–∫–∞ 31)
     2. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª –≤–æ –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é (—Å—Ç—Ä–æ–∫–∞ 35-45)
        - –ü—É—Ç—å: `backend/data/temp/input_{uuid}.csv`
     3. –ó–∞–ø—É—Å–∫–∞–µ—Ç ML —Å–∫—Ä–∏–ø—Ç (—Å—Ç—Ä–æ–∫–∞ 50-71)
        - –ö–æ–º–∞–Ω–¥–∞: `python ml_script_clients.py {input_file} {output_file}`
        - –í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
        - –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: `backend/data/fin_clients.csv`
     4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ (—Å—Ç—Ä–æ–∫–∞ 74)
     5. –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ –ë–î (—Å—Ç—Ä–æ–∫–∞ 81-82)
     6. –í—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ CSV (—Å—Ç—Ä–æ–∫–∞ 86-87)

### 3. **ML Script - –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**
   **–§–∞–π–ª:** `backend/ml_script_clients.py`
   - **–°—Ç—Ä–æ–∫–∞ 26-90:** –§—É–Ω–∫—Ü–∏—è `process_clients`
   - **–ü—Ä–æ—Ü–µ—Å—Å:**
     1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Ö–æ–¥–Ω–æ–π CSV –≤ pandas DataFrame (—Å—Ç—Ä–æ–∫–∞ 46)
     2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥–µ–ª—å XGBoost –∏–∑ `backend/model.json` (—Å—Ç—Ä–æ–∫–∞ 53-58)
     3. –î–µ–ª–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (—Å—Ç—Ä–æ–∫–∞ 67)
     4. –í—ã—á–∏—Å–ª—è–µ—Ç `hdb_income_ratio` (—Å—Ç—Ä–æ–∫–∞ 70-74)
     5. –°–æ–∑–¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π DataFrame —Å –ø–æ–ª—è–º–∏:
        - id, target, incomeValue, avg_cur_cr_turn, ovrd_sum, loan_cur_amt, hdb_income_ratio
     6. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `backend/data/fin_clients.csv` (—Å—Ç—Ä–æ–∫–∞ 88)

### 4. **Backend - –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –ë–î**
   **–§–∞–π–ª:** `backend/scripts/load_clients.py`
   - **–°—Ç—Ä–æ–∫–∞ 28-95:** –§—É–Ω–∫—Ü–∏—è `load_clients_from_csv`
   - **–ü—Ä–æ—Ü–µ—Å—Å:**
     1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç `fin_clients.csv` (—Å—Ç—Ä–æ–∫–∞ 54)
     2. –ü–∞—Ä—Å–∏—Ç –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É CSV (—Å—Ç—Ä–æ–∫–∞ 57-84):
        - `id` ‚Üí String
        - `target` ‚Üí Float (nullable)
        - `incomeValue` ‚Üí Float (nullable)
        - `avg_cur_cr_turn` ‚Üí Float (nullable)
        - `ovrd_sum` ‚Üí Float (default 0.0)
        - `loan_cur_amt` ‚Üí Float (default 0.0)
        - `hdb_income_ratio` ‚Üí Float (nullable)
     3. –°–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã Client (—Å—Ç—Ä–æ–∫–∞ 69-77)
     4. –î–æ–±–∞–≤–ª—è–µ—Ç –≤ —Å–µ—Å—Å–∏—é –ë–î (—Å—Ç—Ä–æ–∫–∞ 79)
     5. –ö–æ–º–º–∏—Ç–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (—Å—Ç—Ä–æ–∫–∞ 86)

### 5. **Database - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**
   **–§–∞–π–ª:** `backend/app/data/models.py`
   - **–°—Ç—Ä–æ–∫–∞ 28-41:** –ú–æ–¥–µ–ª—å Client
   - SQLAlchemy –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –æ–±—ä–µ–∫—Ç—ã –≤ SQL INSERT –∑–∞–ø—Ä–æ—Å—ã
   - –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü—É `clients` –≤ PostgreSQL

## üîç –¢–æ—á–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –æ—à–∏–±–æ–∫

1. **Frontend –æ—à–∏–±–∫–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Network tab - —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞ –æ—Ç `/clients/upload-csv`

2. **Backend endpoint –æ—à–∏–±–∫–∏:**
   - –õ–æ–≥–∏ –≤ `backend/app/api/v1/endpoints/clients.py`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 58-63 (–æ—à–∏–±–∫–∏ ML —Å–∫—Ä–∏–ø—Ç–∞)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä–æ–∫—É 74 (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä–æ–∫—É 101 (–æ–±—â–∏–µ –æ—à–∏–±–∫–∏)

3. **ML —Å–∫—Ä–∏–ø—Ç –æ—à–∏–±–∫–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `backend/ml_script_clients.py`
   - –õ–æ–≥–∏ –≤ stdout/stderr ML —Å–∫—Ä–∏–ø—Ç–∞ (–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ endpoint)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ `backend/model.json`

4. **–ó–∞–≥—Ä—É–∑–∫–∞ –≤ –ë–î –æ—à–∏–±–∫–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `backend/scripts/load_clients.py`
   - –õ–æ–≥–∏ –Ω–∞ —Å—Ç—Ä–æ–∫–∞—Ö 82-83 (–æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å—Ç—Ä–æ–∫)
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç CSV —Ñ–∞–π–ª–∞ `fin_clients.csv`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª–µ–π –≤ CSV –∏ –º–æ–¥–µ–ª–∏

5. **Database –æ—à–∏–±–∫–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã `clients`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ SQLAlchemy

## üìù –§–æ—Ä–º–∞—Ç CSV —Ñ–∞–π–ª–∞

–í—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª (–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º):
- –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ª—é–±—ã–µ –ø–æ–ª—è
- ML —Å–∫—Ä–∏–ø—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –Ω—É–∂–Ω—ã–µ

–í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª (`fin_clients.csv`):
```
id,target,incomeValue,avg_cur_cr_turn,ovrd_sum,loan_cur_amt,hdb_income_ratio
1,12345.67,50000.0,10000.0,0.0,200000.0,0.5
```


